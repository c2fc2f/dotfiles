#!/bin/bash

# Define download URL and file paths
URL="https://discord.com/api/download/canary?platform=linux&format=tar.gz"
FILE="/tmp/discord-canary.tar.gz"
DESTINATION="/opt"
UNCOMPRESS="/tmp/DiscordCanary"

# Download tar.gz file
echo "Download Discord Canary..."
curl -o "$FILE" -L "$URL"

# Check if the download was successful
if [ -f "$FILE" ]; then
    echo "Download successful. File decompression..."
    # Uncompress the file in /tmp
    tar -xzf "$FILE" -C /tmp

    # Copy decompressed content to /opt
    echo "Copy decompressed files to $DESTINATION..."
    sudo cp -r "$UNCOMPRESS" "$DESTINATION"

    # Clean up tar.gz file
    echo "Cleaning..."
    rm "$FILE"
    rm -rf "$UNCOMPRESS"

    echo "Installation successfully completed!"
else
    echo "Error: The file was not downloaded correctly."
fi
